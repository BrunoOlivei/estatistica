
# Introdução

Frequentemente estaremos interessados em analisar o comportamento conjunto de duas ou mais variáveis aleatórias.

O principal objetivo das análises nessa situação é explorar relações (similaridades) entre as colunas, ou algumas vezes entre as linhas, sendo a distribuição conjunta de frequências um instrumento poderoso para a compreensão do comportamento dos dados. 

Um exemplo seria comparar os salários dos casados e solteiros, uma reordenação dos dados poderia colocar os casados na primeira posição e os solteiros nas últimas, e nosso objetivo passaria a ser comparar, na coluna de salários, o comportamento de S na parte superior com a inferior. A apresentação de um ou outro modo será ditada principalmente pelo interesse e técnicas de análise à disposição do pesquisador.

Quando consideramos duas variáveis (ou dois conjuntos de dados), podemos ter três situações:

1. as duas variáveis são qualitativas;
2. as duas variáveis são quantitativas; e
3. uma variável é qualitativa e a outra é quantitativa.

As técnicas de análise de dados nas três situações são diferentes. Quando as variáveis são **qualitativas** os dados são resumidos em _tabelas de dupla entrada (ou de contingência)_, em que aparecerão as **frequências absolutas ou contagens de indivíduos** que pertencem simultaneamente a categorias de uma e outra variável. Quando as duas variáveis são **quantitativas**, as **observações são provenientes de mensurações**, e técnicas como **gráficos de dispersão** ou de **quantis** são apropriadas. Quando temos uma variável **qualitativa e outra quantitativa**, em geral, analisamos **o que acontece com a variável quantitativa quando os dados são categorizados de acordo com os diversos atributos da variável qualitativa**. Mas podemos ter também o caso de duas variáveis quantitativas agrupadas em classes. Por exemplo, podemos querer analisar a associação entre renda e consumo de certo número de famílias e, para isso agrupamos as famílias em classes de renda e classes de consumo. Desse modo, recaímos novamente numa tabela de dupla entrada.

Para efeitos práticos, iremos entender a existência de associação como a _mudança_ de opinião sobre o comportamento de uma variável na presença ou não de informações sobre a segunda variável. 

Exemplo: existe relação entre a altura de pessoas e o sexo em dada comunidade? Pode se fazer uma primeira pergunta: qual a frequência esperada de uma pessoa dessa população ter mais de 170cm de altura? E também uma segunda: qual a frequência esperada de uma mulher ter mais de 170cm de altura? Se a resposta para as duas perguntas for a mesma, diríamos que _não há_ associação entre as variáveis altura e sexo. Porém se as respostas forem diferentes, isso significa uma provável associação, e devemos incorporar esse conhecimento para melhorar o entendimento sobre os comportamentos da variáveis. 

# Variáveis Qualitativas

Suponha que queiramos analisar o comportamento conjunto das variáveis grau de instrução e região de procedência.

```python
df_pivot = pd.pivot_table(df[['Região de Procedência', 'Grau de Instrução']], 
                index="Região de Procedência",
                columns="Grau de Instrução", 
                aggfunc=len)
df_pivot.loc["Total"] = df_pivot.sum() # Total das colunas
df_pivot["Total"] = df_pivot.sum(axis=1) # Total das linhas
```

Grau de Instrução / Região de Procedência | ensino fundamental |ensino médio | superior | Total 
------------------------------------------|--------------------|-------------|----------|-------
capital | 4| 5| 2| 11 
interior | 3| 7| 2| 12
outra | 5 | 6 | 2 | 13
Total | 12 | 18| 6 | 36

A linha de totais fornece a distribuição da variável Grau de Instrução, enquanto a coluna dos totais fornece a distribuição da variável Região de Procedência, sendo chamadas de _distribuições marginais_ enquanto a tabela constitui a _distribuição conjunta de Grua de Instrução e Região de Procedência_. 

Aqui existem três possibilidades de expressar a proporção de cada casela:

1. em relação ao total geral;
2. em relação ao total de cada linha;
3. ou em relação ao total de cada coluna.

De acordo com o objetivo do problema em estudo, uma delas será a mais conveniente.

A tabela a seguir apresenta a distribuição conjunta das frequências relativas, expressas como proporções do total geral. 

```python
df_pivot = pd.pivot_table(
    df[['Região de Procedência', 'Grau de Instrução']], 
    index="Região de Procedência",
    columns="Grau de Instrução", 
    aggfunc=lambda x: int(round(len(x) / len(df) * 100, 0)),
    margins=True,
    margins_name="Total",
)
df_pivot
```

Grau de Instrução / Região de Procedência | ensino fundamental |ensino médio | superior | Total 
------------------------------------------|--------------------|-------------|----------|-------
capital | 11 | 14 | 6 | 31 
interior | 8 | 19 | 6 | 33
outra | 14 | 17 | 6 | 36
Total | 33 | 50 | 17 | 100

A tabela seguinte apresenta a distribuição das proporções em relação ao total das colunas.

```python
joint_df = (pd.crosstab(index=df["Região de Procedência"],
                       columns=df["Grau de Instrução"],
                       normalize="columns") * 100).round(0).astype(int)
joint_df.loc["Total"] = joint_df.sum()
joint_df
```

Grau de Instrução / Região de Procedência | ensino fundamental |ensino médio | superior  
------------------------------------------|--------------------|-------------|----------
capital | 33 | 28 | 33  
interior | 25 | 39 | 33 
outra | 42 | 33 | 33 
Total | 100 | 100 | 100

```python
sns.set()
joint_df.iloc[:3].T.plot(kind='bar', stacked=True)
```

![[Distribuição da região de procedência por grau de instrução.png]]